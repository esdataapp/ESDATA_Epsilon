# ğŸ“ ESTRUCTURA DEL PROYECTO - Dashboard ZMG

## ğŸ—ï¸ **ORGANIZACIÃ“N COMPLETA**

```
Dashboard/
â”œâ”€â”€ ğŸ“‹ DOCUMENTACIÃ“N/
â”‚   â”œâ”€â”€ PLAN_DASHBOARD_ZMG_COMPLETO.md
â”‚   â”œâ”€â”€ ARQUITECTURA_TECNICA.md
â”‚   â”œâ”€â”€ ESTRUCTURA_PROYECTO.md
â”‚   â””â”€â”€ guias/
â”‚       â”œâ”€â”€ GUIA_DESARROLLO.md
â”‚       â”œâ”€â”€ GUIA_DEPLOYMENT.md
â”‚       â””â”€â”€ GUIA_USUARIO.md
â”‚
â”œâ”€â”€ ğŸ”§ CONFIGURACIÃ“N/
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ scripts/
â”‚       â”œâ”€â”€ setup.sh
â”‚       â”œâ”€â”€ migrate.sh
â”‚       â””â”€â”€ seed.sh
â”‚
â”œâ”€â”€ ğŸ—„ï¸ BACKEND/ (NestJS)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.ts
â”‚   â”‚   â”œâ”€â”€ app.module.ts
â”‚   â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”‚   â”œâ”€â”€ prisma.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ prisma.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ schema.prisma
â”‚   â”‚   â”œâ”€â”€ stats/
â”‚   â”‚   â”‚   â”œâ”€â”€ stats.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ stats.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ stats.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚   â”‚       â”œâ”€â”€ filter.dto.ts
â”‚   â”‚   â”‚       â””â”€â”€ overview.dto.ts
â”‚   â”‚   â”œâ”€â”€ geo/
â”‚   â”‚   â”‚   â”œâ”€â”€ geo.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ geo.controller.ts
â”‚   â”‚   â”‚   â””â”€â”€ geo.service.ts
â”‚   â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â”‚   â”œâ”€â”€ analysis.module.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ analysis.controller.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ analysis.service.ts
â”‚   â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚   â”‚       â”œâ”€â”€ correlation.service.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ clustering.service.ts
â”‚   â”‚   â”‚       â””â”€â”€ segmentation.service.ts
â”‚   â”‚   â”œâ”€â”€ cache/
â”‚   â”‚   â”‚   â”œâ”€â”€ cache.module.ts
â”‚   â”‚   â”‚   â””â”€â”€ cache.service.ts
â”‚   â”‚   â””â”€â”€ common/
â”‚   â”‚       â”œâ”€â”€ decorators/
â”‚   â”‚       â”œâ”€â”€ filters/
â”‚   â”‚       â”œâ”€â”€ guards/
â”‚   â”‚       â””â”€â”€ interceptors/
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â””â”€â”€ nest-cli.json
â”‚
â”œâ”€â”€ ğŸ¨ FRONTEND/ (React + Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.tsx
â”‚   â”‚   â”œâ”€â”€ App.tsx
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/ (shadcn/ui)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sheet.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ slider.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AppLayout.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BottomNavigation.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ FilterSheet.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ charts/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BaseChart.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ BarChart.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LineChart.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ScatterChart.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HeatmapChart.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ComposedChart.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ maps/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MapContainer.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HeatmapLayer.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ColonyBoundaries.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ PropertyMarkers.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ filters/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PriceRangeSlider.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PropertyTypeSelect.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ColonySearch.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AmenityFilter.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ FilterChips.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ cards/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MetricCard.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ InsightCard.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PropertyCard.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ColonyCard.tsx
â”‚   â”‚   â”‚   â””â”€â”€ segments/
â”‚   â”‚   â”‚       â”œâ”€â”€ SegmentBuilder.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ SegmentComparator.tsx
â”‚   â”‚   â”‚       â””â”€â”€ SegmentAnalysis.tsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Inicio.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Explorar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Segmentos.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Analitica.tsx
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useFilters.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useStats.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useDebounce.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useLocalStorage.ts
â”‚   â”‚   â”‚   â””â”€â”€ useInfiniteScroll.ts
â”‚   â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboardStore.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ filtersStore.ts
â”‚   â”‚   â”‚   â””â”€â”€ uiStore.ts
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ statsService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ geoService.ts
â”‚   â”‚   â”‚   â””â”€â”€ analysisService.ts
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ calculations.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ constants.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ colors.ts
â”‚   â”‚   â”‚   â””â”€â”€ validators.ts
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ filters.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ charts.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ geo.ts
â”‚   â”‚   â”‚   â””â”€â”€ segments.ts
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â”‚       â”œâ”€â”€ globals.css
â”‚   â”‚       â””â”€â”€ components.css
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ icons/
â”‚   â”‚   â””â”€â”€ images/
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ ğŸ PYTHON_SYNC/ (IntegraciÃ³n con pipeline)
â”‚   â”œâ”€â”€ sync_data.py
â”‚   â”œâ”€â”€ calculate_stats.py
â”‚   â”œâ”€â”€ correlation_analysis.py
â”‚   â”œâ”€â”€ clustering_analysis.py
â”‚   â”œâ”€â”€ amenity_analysis.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ config/
â”‚       â”œâ”€â”€ database.py
â”‚       â””â”€â”€ settings.py
â”‚
â””â”€â”€ ğŸ§ª TESTING/
    â”œâ”€â”€ backend/
    â”‚   â”œâ”€â”€ unit/
    â”‚   â”œâ”€â”€ integration/
    â”‚   â””â”€â”€ e2e/
    â”œâ”€â”€ frontend/
    â”‚   â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ pages/
    â”‚   â””â”€â”€ utils/
    â””â”€â”€ python/
        â”œâ”€â”€ test_sync.py
        â””â”€â”€ test_calculations.py
```

---

## ğŸš€ **SCRIPTS DE CONFIGURACIÃ“N INICIAL**

### 1. Setup Principal
```bash
#!/bin/bash
# scripts/setup.sh

echo "ğŸ—ï¸  Configurando Dashboard ZMG..."

# Crear directorios principales
mkdir -p backend frontend python_sync testing

# Backend setup
echo "ğŸ“¦ Configurando Backend (NestJS)..."
cd backend
npm init -y
npm install @nestjs/core @nestjs/common @nestjs/platform-express
npm install @prisma/client prisma
npm install @nestjs/cache-manager cache-manager-redis-store
npm install class-validator class-transformer
npm install --save-dev @nestjs/cli @types/node typescript

# Frontend setup
echo "ğŸ¨ Configurando Frontend (React + Vite)..."
cd ../frontend
npm create vite@latest . -- --template react-ts
npm install
npm install @tanstack/react-query zustand
npm install recharts mapbox-gl
npm install @radix-ui/react-slider @radix-ui/react-select
npm install tailwindcss @tailwindcss/forms
npm install lucide-react
npm install react-hook-form @hookform/resolvers zod

# Python sync setup
echo "ğŸ Configurando Python Sync..."
cd ../python_sync
python -m venv venv
source venv/bin/activate  # En Windows: venv\Scripts\activate
pip install pandas numpy sqlalchemy psycopg2-binary
pip install scikit-learn scipy
pip install python-dotenv

echo "âœ… Setup completado!"
echo "ğŸ“‹ PrÃ³ximos pasos:"
echo "1. Configurar variables de entorno (.env)"
echo "2. Ejecutar docker-compose up -d"
echo "3. Ejecutar migraciones de base de datos"
echo "4. Sincronizar datos iniciales"
```

### 2. Docker Compose
```yaml
# docker-compose.yml
version: '3.8'

services:
  postgres:
    image: postgis/postgis:15-3.3
    container_name: dashboard_postgres
    environment:
      POSTGRES_DB: dashboard_zmg
      POSTGRES_USER: dashboard
      POSTGRES_PASSWORD: ${DB_PASSWORD:-dashboard123}
      POSTGRES_HOST_AUTH_METHOD: trust
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./backend/prisma/init.sql:/docker-entrypoint-initdb.d/init.sql
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U dashboard -d dashboard_zmg"]
      interval: 10s
      timeout: 5s
      retries: 5

  redis:
    image: redis:7-alpine
    container_name: dashboard_redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 3s
      retries: 5

  backend:
    build: 
      context: ./backend
      dockerfile: Dockerfile
    container_name: dashboard_backend
    ports:
      - "3001:3001"
    environment:
      DATABASE_URL: postgresql://dashboard:${DB_PASSWORD:-dashboard123}@postgres:5432/dashboard_zmg
      REDIS_URL: redis://redis:6379
      NODE_ENV: development
      PORT: 3001
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
    volumes:
      - ./backend:/app
      - /app/node_modules
    command: npm run start:dev

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: dashboard_frontend
    ports:
      - "5173:5173"
    environment:
      VITE_API_BASE_URL: http://localhost:3001
      VITE_MAPBOX_TOKEN: ${MAPBOX_TOKEN}
    depends_on:
      - backend
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev -- --host 0.0.0.0

volumes:
  postgres_data:
  redis_data:

networks:
  default:
    name: dashboard_network
```

### 3. Variables de Entorno
```env
# .env.example

# Database
DB_PASSWORD=dashboard123
DATABASE_URL=postgresql://dashboard:dashboard123@localhost:5432/dashboard_zmg

# Redis
REDIS_URL=redis://localhost:6379

# API
API_PORT=3001
API_BASE_URL=http://localhost:3001

# Frontend
VITE_API_BASE_URL=http://localhost:3001
VITE_MAPBOX_TOKEN=your_mapbox_token_here

# Cache TTL (seconds)
CACHE_TTL_OVERVIEW=900
CACHE_TTL_FILTERED=300
CACHE_TTL_CORRELATIONS=1800
CACHE_TTL_CLUSTERS=3600

# Python Sync
PYTHON_SYNC_INTERVAL=86400  # 24 hours
DATA_SOURCE_PATH=/path/to/esdata/output

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# Security
JWT_SECRET=your_jwt_secret_here
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# Performance
MAX_QUERY_RESULTS=10000
QUERY_TIMEOUT=30000
```

---

## ğŸ“¦ **PACKAGE.JSON TEMPLATES**

### Backend Package.json
```json
{
  "name": "dashboard-zmg-backend",
  "version": "1.0.0",
  "description": "Backend API para Dashboard Inmobiliario ZMG",
  "main": "dist/main.js",
  "scripts": {
    "build": "nest build",
    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
    "start": "nest start",
    "start:dev": "nest start --watch",
    "start:debug": "nest start --debug --watch",
    "start:prod": "node dist/main",
    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:cov": "jest --coverage",
    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
    "test:e2e": "jest --config ./test/jest-e2e.json",
    "prisma:generate": "prisma generate",
    "prisma:migrate": "prisma migrate dev",
    "prisma:seed": "ts-node prisma/seed.ts"
  },
  "dependencies": {
    "@nestjs/common": "^10.0.0",
    "@nestjs/core": "^10.0.0",
    "@nestjs/platform-express": "^10.0.0",
    "@nestjs/cache-manager": "^2.1.0",
    "@nestjs/throttler": "^5.0.0",
    "@prisma/client": "^5.0.0",
    "cache-manager": "^5.2.3",
    "cache-manager-redis-store": "^3.0.1",
    "class-transformer": "^0.5.1",
    "class-validator": "^0.14.0",
    "prisma": "^5.0.0",
    "redis": "^4.6.7",
    "reflect-metadata": "^0.1.13",
    "rxjs": "^7.8.1"
  },
  "devDependencies": {
    "@nestjs/cli": "^10.0.0",
    "@nestjs/schematics": "^10.0.0",
    "@nestjs/testing": "^10.0.0",
    "@types/express": "^4.17.17",
    "@types/jest": "^29.5.2",
    "@types/node": "^20.3.1",
    "@types/supertest": "^2.0.12",
    "@typescript-eslint/eslint-plugin": "^6.0.0",
    "@typescript-eslint/parser": "^6.0.0",
    "eslint": "^8.42.0",
    "eslint-config-prettier": "^9.0.0",
    "eslint-plugin-prettier": "^5.0.0",
    "jest": "^29.5.0",
    "prettier": "^3.0.0",
    "source-map-support": "^0.5.21",
    "supertest": "^6.3.3",
    "ts-jest": "^29.1.0",
    "ts-loader": "^9.4.3",
    "ts-node": "^10.9.1",
    "tsconfig-paths": "^4.2.0",
    "typescript": "^5.1.3"
  }
}
```

### Frontend Package.json
```json
{
  "name": "dashboard-zmg-frontend",
  "version": "1.0.0",
  "type": "module",
  "description": "Frontend para Dashboard Inmobiliario ZMG",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
    "preview": "vite preview",
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:coverage": "vitest --coverage"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.15.0",
    "@tanstack/react-query": "^4.32.6",
    "zustand": "^4.4.1",
    "recharts": "^2.8.0",
    "mapbox-gl": "^2.15.0",
    "react-map-gl": "^7.1.6",
    "@radix-ui/react-slider": "^1.1.2",
    "@radix-ui/react-select": "^1.2.2",
    "@radix-ui/react-dialog": "^1.0.4",
    "@radix-ui/react-tabs": "^1.0.4",
    "react-hook-form": "^7.45.4",
    "@hookform/resolvers": "^3.3.1",
    "zod": "^3.22.2",
    "lucide-react": "^0.263.1",
    "clsx": "^2.0.0",
    "tailwind-merge": "^1.14.0",
    "framer-motion": "^10.16.4",
    "react-window": "^1.8.8",
    "react-virtualized-auto-sizer": "^1.0.20"
  },
  "devDependencies": {
    "@types/react": "^18.2.15",
    "@types/react-dom": "^18.2.7",
    "@types/react-window": "^1.8.5",
    "@typescript-eslint/eslint-plugin": "^6.0.0",
    "@typescript-eslint/parser": "^6.0.0",
    "@vitejs/plugin-react": "^4.0.3",
    "autoprefixer": "^10.4.14",
    "eslint": "^8.45.0",
    "eslint-plugin-react-hooks": "^4.6.0",
    "eslint-plugin-react-refresh": "^0.4.3",
    "postcss": "^8.4.27",
    "tailwindcss": "^3.3.3",
    "typescript": "^5.0.2",
    "vite": "^4.4.5",
    "vitest": "^0.34.6",
    "@vitest/ui": "^0.34.6",
    "jsdom": "^22.1.0"
  }
}
```

---

## ğŸ”§ **CONFIGURACIONES TÃ‰CNICAS**

### Tailwind Config
```javascript
// frontend/tailwind.config.js
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#1a365d',
          600: '#1e40af',
          700: '#1d4ed8',
        },
        accent: {
          50: '#ecfdf5',
          500: '#10b981',
          600: '#059669',
        },
        warning: {
          50: '#fffbeb',
          500: '#f59e0b',
          600: '#d97706',
        }
      },
      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif'],
      },
      spacing: {
        '18': '4.5rem',
        '88': '22rem',
      },
      animation: {
        'fade-in': 'fadeIn 0.5s ease-in-out',
        'slide-up': 'slideUp 0.3s ease-out',
      }
    },
  },
  plugins: [
    require('@tailwindcss/forms'),
  ],
}
```

### Vite Config
```typescript
// frontend/vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:3001',
        changeOrigin: true,
        secure: false,
      }
    }
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          charts: ['recharts'],
          maps: ['mapbox-gl', 'react-map-gl'],
        }
      }
    }
  },
  optimizeDeps: {
    include: ['react', 'react-dom', 'recharts', 'mapbox-gl']
  }
})
```

---

Esta estructura proporciona una base sÃ³lida y escalable para el desarrollo del dashboard. Â¿Te gustarÃ­a que continÃºe con la implementaciÃ³n de algÃºn componente especÃ­fico o prefieres que avance con la configuraciÃ³n de la base de datos?
