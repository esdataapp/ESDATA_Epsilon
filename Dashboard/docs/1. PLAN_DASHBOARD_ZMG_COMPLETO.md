# üè¢ PLAN COMPLETO - Dashboard Inmobiliario ZMG
## Inteligencia de Mercado para la Zona Metropolitana de Guadalajara

---

## üìã **RESUMEN EJECUTIVO**

### Objetivo
Crear un dashboard din√°mico y moderno para an√°lisis de inteligencia de mercado inmobiliario de la ZMG, que sirva desde usuarios b√°sicos hasta equipos corporativos para la toma de decisiones estrat√©gicas.

### Alcance del Proyecto
- **Datos**: 25,851 propiedades procesadas, 1,062 colonias mapeadas
- **Cobertura**: Guadalajara y Zapopan (ZMG)
- **Usuarios**: Asesores, brokers, constructoras, inversionistas, bancos, notar√≠as
- **Plataforma**: Web responsive, mobile-first

---

## üéØ **FASE 1: ARQUITECTURA Y FUNDAMENTOS**

### 1.1 Stack Tecnol√≥gico Optimizado

#### Frontend
```json
{
  "core": {
    "framework": "Vite + React 18 + TypeScript",
    "styling": "Tailwind CSS + shadcn/ui",
    "icons": "Lucide React",
    "state": "Zustand (lightweight)",
    "data": "TanStack Query (caching)",
    "forms": "React Hook Form + Zod"
  },
  "visualization": {
    "charts": "Recharts (React-optimized)",
    "maps": "Mapbox GL JS",
    "animations": "Framer Motion (minimal)"
  },
  "mobile": {
    "gestures": "React Spring",
    "navigation": "React Router v6",
    "sheets": "Vaul (bottom sheets)"
  }
}
```

#### Backend
```json
{
  "api": "NestJS + Prisma",
  "database": "PostgreSQL + PostGIS (Supabase)",
  "cache": "Redis (agregaciones)",
  "storage": "Supabase Storage",
  "auth": "Supabase Auth (opcional)"
}
```

### 1.2 Arquitectura de Datos (3 Capas)

#### Capa 1: Pre-procesamiento (Python - Batch)
- **Frecuencia**: Cada 15 d√≠as (sincronizado con pipeline existente)
- **Responsabilidades**: Estad√≠sticos, correlaciones, clustering, estratos, outliers

#### Capa 2: API Cache (NestJS - Tiempo Real)
- **Frecuencia**: 15-30 minutos
- **Responsabilidades**: Agregaciones din√°micas, percentiles, cache de consultas

#### Capa 3: Frontend (React - Interactivo)
- **Responsabilidades**: C√°lculos visuales, filtros, transformaciones, interacciones

---

## üé® **FASE 2: DISE√ëO UX/UI MOBILE-FIRST**

### 2.1 Principios de Dise√±o

#### Mobile-First Strategy
- **Navegaci√≥n**: Bottom tabs + thumb-friendly controls
- **√Årea t√°ctil**: M√≠nimo 44px
- **Performance**: < 200ms respuesta en filtros

#### Sistema de Colores
```css
:root {
  --primary-blue: #1a365d;      /* Confianza */
  --accent-green: #10b981;      /* Crecimiento */
  --warning-amber: #f59e0b;     /* Oportunidad */
  --danger-red: #ef4444;        /* Alerta */
  --neutral-gray: #f3f4f6;      /* Base */
}
```

---

## üìä **FASE 3: ESTRUCTURA DE VISTAS**

### 3.1 Navegaci√≥n Principal (Bottom Tabs)

#### Tab 1: üè† Inicio (Insights)
**Objetivo**: "El estado del mercado en 5 segundos"
- KPIs Hero: Precio promedio ZMG, cambio mensual
- Insights Autom√°ticos: Top 5 colonias en crecimiento
- Mini Mapa de Calor: Precio por m¬≤ por colonia
- Gr√°fica Combinada: Barras + L√≠nea

#### Tab 2: üó∫Ô∏è Explorar
**Objetivo**: "Encuentra tu nicho de mercado"
- Mapa Interactivo: Coropl√©tico por precio/m¬≤
- Lista de Propiedades: Virtualized list
- Histograma Din√°mico: Con brush para sliders
- Dispersi√≥n: Superficie vs Precio

#### Tab 3: üéØ Segmentos
**Objetivo**: "An√°lisis por segmentaci√≥n personalizada"
- Segment Builder: Constructor visual con presets
- Comparador: 2-3 segmentos lado a lado
- Rangos Autom√°ticos: P25-P75 por segmento
- Distribuci√≥n Geogr√°fica: Por colonia/municipio

#### Tab 4: üìà Anal√≠tica
**Objetivo**: "Insights profundos y correlaciones"
- Matriz de Correlaci√≥n: Heatmap interactivo
- An√°lisis de Clusters: Radar charts + descripciones
- Lift de Amenidades: Ranking con intervalos
- Series Temporales: Evoluci√≥n de precios

### 3.2 Filtros Din√°micos

#### Filtros Primarios (Siempre Visibles)
- Rango de precio
- Tipo de propiedad
- Tipo de operaci√≥n
- Ubicaci√≥n

#### Filtros Secundarios (Bottom Sheet)
- Rango de superficie
- Precio por m¬≤
- Rec√°maras y ba√±os
- Amenidades
- Incluir outliers

---

## üìà **FASE 4: VISUALIZACIONES ESPECIALIZADAS**

### 4.1 Matriz de Gr√°ficas por Objetivo

| Objetivo | Gr√°fica | Insight Clave |
|----------|---------|---------------|
| **Comparar colonias** | Barras horizontales | "Polanco 3x m√°s caro" |
| **Tendencias** | L√≠neas + √°rea | "Mercado subi√≥ 15% Q4" |
| **Composici√≥n** | Treemap | "Deptos = 45% inventario" |
| **Correlaci√≥n** | Dispersi√≥n | "Sweet spot: 120-150m¬≤" |
| **Distribuci√≥n** | Histograma + Box | "80% entre $2M-5M" |
| **Performance geo** | Mapa calor | "Providencia lidera ROI" |

---

## üîß **FASE 5: BACKEND Y APIs**

### 5.1 Modelo de Datos

#### Tabla Principal: `listings_processed`
```sql
CREATE TABLE listings_processed (
  id UUID PRIMARY KEY,
  operation VARCHAR(20),
  property_type VARCHAR(30),
  city VARCHAR(50),
  colony VARCHAR(100),
  location POINT,
  price DECIMAL(12,2),
  surface_m2 DECIMAL(8,2),
  price_per_sqm DECIMAL(10,2),
  bedrooms INTEGER,
  bathrooms DECIMAL(3,1),
  amenities JSONB,
  is_outlier BOOLEAN DEFAULT FALSE
);
```

#### Tabla de Agregaciones: `market_stats`
```sql
CREATE TABLE market_stats (
  geo_level VARCHAR(20),
  geo_id VARCHAR(100),
  property_type VARCHAR(30),
  operation VARCHAR(20),
  count_total INTEGER,
  price_median DECIMAL(12,2),
  price_p25 DECIMAL(12,2),
  price_p75 DECIMAL(12,2),
  surface_median DECIMAL(8,2),
  pxm2_median DECIMAL(10,2)
);
```

### 5.2 Endpoints API

#### GET `/api/stats/overview`
```json
{
  "data": {
    "total_properties": 25851,
    "avg_price": 3200000,
    "avg_price_change_30d": 12.5,
    "top_colonies": [...]
  }
}
```

#### POST `/api/stats/filtered`
```json
{
  "filters": {
    "property_type": ["Departamento"],
    "price_range": [1000000, 5000000]
  }
}
```

---

## üì± **FASE 6: IMPLEMENTACI√ìN FRONTEND**

### 6.1 Estructura de Proyecto
```
dashboard-zmg/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/           # shadcn/ui
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ charts/       # Recharts wrappers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ maps/         # Mapbox components
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ filters/      # Filter components
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Inicio.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Explorar.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Segmentos.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Analitica.tsx
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ store/
‚îÇ   ‚îî‚îÄ‚îÄ types/
```

### 6.2 Estado Global (Zustand)
```typescript
interface DashboardState {
  filters: FilterState;
  setFilters: (filters: Partial<FilterState>) => void;
  overview: OverviewData | null;
  activeTab: TabType;
  isFilterSheetOpen: boolean;
}
```

---

## üöÄ **FASE 7: OPTIMIZACI√ìN Y PERFORMANCE**

### 7.1 Estrategias de Performance
- Code Splitting por rutas
- Virtualizaci√≥n de listas largas
- Memoizaci√≥n de gr√°ficas complejas
- Cache inteligente con TanStack Query
- Debouncing de filtros (300ms)

### 7.2 Optimizaci√≥n Mobile
- Touch gestures para navegaci√≥n
- Bottom sheets para filtros
- Responsive breakpoints
- Lazy loading de componentes pesados

---

## üìä **FASE 8: SEGMENTACI√ìN AVANZADA**

### 8.1 Presets Predefinidos
```json
{
  "starter": {
    "name": "Starter (1R + 1-1.5B)",
    "bedrooms": [1],
    "bathrooms": [1, 1.5]
  },
  "family": {
    "name": "Familiar (2R + 2-2.5B)",
    "bedrooms": [2],
    "bathrooms": [2, 2.5]
  }
}
```

### 8.2 An√°lisis Autom√°tico
- Rangos recomendados (P25-P75)
- Distribuci√≥n por colonia
- Comparaci√≥n entre segmentos
- Insights personalizados

---

## üéØ **FASE 9: PLAN DE IMPLEMENTACI√ìN**

### 9.1 Cronograma (8 Semanas)

#### Semana 1-2: Fundamentos
- Setup proyecto (Vite + React + Tailwind)
- Componentes base y dise√±o system
- Estado global con Zustand

#### Semana 3: Backend y APIs
- NestJS + Prisma + PostgreSQL
- Endpoints b√°sicos y cache
- Integraci√≥n con pipeline Python

#### Semana 4: Vista Inicio
- KPIs y m√©tricas principales
- Gr√°ficas combinadas
- Responsive design

#### Semana 5: Vista Explorar
- Mapa interactivo
- Lista virtualizada
- Filtros en tiempo real

#### Semana 6: Vista Segmentos
- Segment Builder
- Comparador de segmentos
- An√°lisis autom√°tico

#### Semana 7: Vista Anal√≠tica
- Correlaciones y clusters
- Amenidades y series
- Insights avanzados

#### Semana 8: Optimizaci√≥n
- Performance optimization
- Testing completo
- Deploy a producci√≥n

### 9.2 Entregables

#### M1: MVP Funcional
- Dashboard b√°sico con Inicio
- Filtros principales
- API endpoints b√°sicos

#### M2: Exploraci√≥n Completa
- Todas las vistas implementadas
- Mapa interactivo
- Sistema de cache

#### M3: Anal√≠tica Avanzada
- Segmentaci√≥n completa
- Performance optimizada
- Testing completo

#### M4: Producci√≥n
- Deploy en producci√≥n
- Documentaci√≥n completa
- Training para usuarios

---

## üîç **CONSIDERACIONES T√âCNICAS**

### Integraci√≥n con Pipeline Existente
- Utilizar datos procesados del pipeline ESDATA_Epsilon
- Sincronizaci√≥n cada 15 d√≠as
- Mantener compatibilidad con estructura actual

### Escalabilidad
- Arquitectura modular para agregar nuevas funcionalidades
- Sistema de plugins para nuevos tipos de an√°lisis
- API versioning para cambios futuros

### Seguridad
- Autenticaci√≥n opcional con Supabase Auth
- Rate limiting en APIs
- Validaci√≥n de datos de entrada

---

## üìù **PR√ìXIMOS PASOS**

1. **Aprobaci√≥n del Plan**: Revisar y aprobar arquitectura propuesta
2. **Setup Inicial**: Configurar repositorios y entornos de desarrollo
3. **Prototipo**: Crear mockups de las vistas principales
4. **Desarrollo Iterativo**: Implementar por fases seg√∫n cronograma
5. **Testing Continuo**: Pruebas con usuarios reales desde M1

---

*Este plan est√° dise√±ado para ser implementado de forma incremental, permitiendo feedback temprano y ajustes seg√∫n las necesidades espec√≠ficas del mercado inmobiliario de la ZMG.*
